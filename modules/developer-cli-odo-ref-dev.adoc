// Module included in the following assemblies:
//
// * cli_reference/developer_cli_odo/odo-cli-reference.adoc

:_content-type: REFERENCE
[id="odo-dev_{context}"]
= odo dev


The `odo dev` command is used to quickly and effectively iterate through your development process for building an application.

This is _inner loop_ development and allows you to code, build, run, and test the application in a continuous workflow.

.Prerequisites
- You must _initialize_ your source code using the `odo init` command.

.Sample command
[source,terminal]
----
$ odo dev
----

.Sample output
[source,terminal]
----
$ odo dev
  __
 /  \__     Developing using the my-nodejs-app Devfile
 \__/  \    Namespace: default
 /  \__/    odo version: v3.0.0-alpha1
 \__/

↪ Deploying to the cluster in developer mode
 ✓  Waiting for Kubernetes resources [3s]
 ✓  Syncing files into the container [335ms]
 ✓  Building your application in container on cluster [2s]
 ✓  Executing the application [1s]

Your application is now running on the cluster
 - Forwarding from 127.0.0.1:40001 -> 3000

Watching for changes in the current directory /Users/user/nodejs

[Ctrl+c] - Exit and delete resources from the cluster
     [p] - Manually apply local changes to the application on the cluster
----

The sample output shows `odo`:

  * Building and deploying your application to the cluster.
  * Port-forwarding your application for local accessibility.
  * Watching for changes in the current directory and rebuilding the application when changes are detected.

You can press `Ctrl+C` at any time to end the development session. The command can take a few moments to end, as it will first delete all resources deployed into the cluster for this session, before terminating.

== Applying local changes to the application on the cluster

By default, changes you make to the Devfile and source files are applied directly.

The flag `--no-watch` can be used to change this behaviour. When you change the Devfile or any source file, the changes will not be applied immediately, but instead the next time you press the `p` key.

Depending on the local changes, different events can occur on the cluster:

* If source files are modified, they are pushed to the container running the application, and:
** If the `run` command is marked as `HotReloadCapable`, the application is responsible for applying the new changes.
** If the `run` command is not marked as `HotReloadCapable`, the application is stopped and then restarted by `odo` using the `build` and `run` commands again.
* If the Devfile is modified, the deployment of the application is modified with the new changes. In some circumstances, this may cause the restart of the container running the application and therefore the application itself.

== Running an alternative command

You can use flags with the `odo dev` command to run alternative `build` and `run` commands.

=== Running an alternative build command
By default, `odo dev` builds the application using the default `build` command defined in the Devfile. 
That is the command with a group `kind` set to `build` and with `isDefault` set to `true`, if it exists.

You can override the default behavior by passing the `--build-command` flag.  `odo` can run any other command, provided it is specified in the `build` group in the Devfile.

For example, given the following excerpt from a Devfile:

[source,yaml]
----
- id: my-build
  exec:
    commandLine: go build main.go
    component: tools
    workingDir: ${PROJECT_SOURCE}
    group:
      isDefault: true
      kind: build

- id: my-build-with-version
  exec:
    commandLine: go build -ldflags="-X main.version=v1.0.0" main.go
    component: tools
    workingDir: ${PROJECT_SOURCE}
    group:
      kind: build
----

Running `odo dev` builds the application using the default `my-build` command.

Running `odo dev --build-command my-build-with-version` builds the application using the `my-build-with-version` command:

.Sample command
[source,terminal]
----
$ odo dev --build-command my-build-with-version
----

.Sample output
[source,terminal]
----
$ odo dev --build-command my-build-with-version

  __
 /  \__     Developing using the my-sample-go Devfile
 \__/  \    Namespace: default
 /  \__/    odo version: v3.0.0-alpha3
 \__/

↪ Deploying to the cluster in developer mode
 ✓  Waiting for Kubernetes resources [39s]
 ✓  Syncing files into the container [84ms]
 ✓  Building your application in container on cluster (command: my-build-with-version) [456ms]
 •  Executing the application (command: run)  ...

Your application is now running on the cluster
 - Forwarding from 127.0.0.1:40001 -> 8080

Watching for changes in the current directory /path/to/my/sources/go-app

[Ctrl+c] - Exit and delete resources from the cluster
     [p] - Manually apply local changes to the application on the cluster
----


=== Running an alternative run command

By default, `odo dev` executes the default `run` command defined in the Devfile. That is the command with a group `kind` set to `run` and its `isDefault` field set to `true`.

You can override this behavior by passing the `run-command` flag.  `odo` can run any other non-default command, provided it is specified in the `run` group in the Devfile.

For example, given the following excerpt from a Devfile:

[source,yaml]
----
- id: my-run
  exec:
    commandLine: mvn spring-boot:run
    component: tools
    workingDir: ${PROJECT_SOURCE}
    group:
      isDefault: true
      kind: run

- id: my-run-with-postgres
  exec:
    commandLine: mvn spring-boot:run -Dspring-boot.run.profiles=postgres
    component: tools
    workingDir: ${PROJECT_SOURCE}
    group:
      isDefault: false
      kind: run
----

Running `odo dev` on its own runs the default `my-run` command.

Running the `odo dev --run-command my-run-with-postgres` command,  `odo` runs the `my-run-with-postgres` command:


.Sample command
[source,terminal]
----
$ odo dev --run-command my-run-with-postgres
----

.Sample output
[source,terminal]
----
$ odo dev --run-command my-run-with-postgres

  __
 /  \__     Developing using the my-java-springboot-app Devfile
 \__/  \    Namespace: default
 /  \__/    odo version: v3.0.0-alpha3
 \__/

↪ Deploying to the cluster in developer mode
 ✓  Added storage m2 to my-java-springboot-app
 ✓  Creating kind ServiceBinding [8ms]
 ✓  Waiting for Kubernetes resources [39s]
 ✓  Syncing files into the container [84ms]
 ✓  Building your application in container on cluster (command: build) [51s]
 •  Executing the application (command: my-run-with-postgres)  ...

Your application is now running on the cluster
 - Forwarding from 127.0.0.1:40002 -> 8080

Watching for changes in the current directory /path/to/my/sources/java-springboot-app

[Ctrl+c] - Exit and delete resources from the cluster
     [p] - Manually apply local changes to the application on the cluster
----

== Overriding variables

You define variables in the Devfile to make it parameterizable. You can override the values for these variables when running `odo dev` from the command line, using the `--var` and `--var-file` options.

The `--var` option is a repeatable option that takes a `variable=value` pair, where `=value` is optional. If the `=value` is omitted, the value is extracted from the environment variable named `variable`. In this case, if an environment variable with this name is not defined, the value falls back to the one defined into the Devfile.

The `--var-file` option takes a filename as argument. The file contains a line-separated list of `variable=value` pairs, with the same behaviour as before.  

Note that the values passed with the `--var` option override the values obtained using the `--var-file` option.

=== Examples of overriding variables

Consider a Devfile with the following `variables` field:

[source,yaml]
----
variables:
  USER: anonymous
  DEBUG: false
...  
----

You can override these values using the following `odo dev` command:

.Sample command
[source,terminal]
----
$ odo dev --var USER --var DEBUG=true
----

This command overrides the `USER` Devfile variable with the value of the `USER` environment variable, if it is defined. It also overrides the value of the `DEBUG` Devfile variable with the value `true` .


You can also override variables using a configuration file rather than individual command line options. Consider the following configuration file:

.Sample `config.vars` file
[source,yaml]
----
USER
DEBUG=true
----

You can run the following command to create the same behaviour as before:

.Sample command with --var-file
[source,terminal]
----
$ odo dev --var-file config.vars
----

If you want to override the `USER` Devfile variable with an explicit value, `john`, in combination with the configuration file, run the command:


.Sample command with --var and --var-file
[source,terminal]
----
$ odo dev --var USER=john --var-file config.vars
----
